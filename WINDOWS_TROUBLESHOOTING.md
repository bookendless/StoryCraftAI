# Windows 11 トラブルシューティングガイド

## よくある問題と解決方法

### 1. start-local.bat が動作しない

#### 症状
- バッチファイルをダブルクリックしても画面がすぐ閉じる
- 実行が開始されない

#### 解決方法
**方法1: コマンドプロンプトから実行**
1. フォルダ内で「Shift + 右クリック」
2. 「PowerShellウィンドウをここで開く」または「コマンドプロンプト」
3. 以下のコマンドを実行：
```cmd
start-local.bat
```

**方法2: 管理者権限で実行**
1. start-local.bat を右クリック
2. 「管理者として実行」を選択

**方法3: 手動実行**
```cmd
node server\index.local.cjs
```

### 2. 「Node.jsが見つかりません」エラー

#### 解決方法
1. [Node.js公式サイト](https://nodejs.org/)から最新版をダウンロード
2. インストール後、コマンドプロンプトを**再起動**
3. 確認コマンド：
```cmd
node --version
npm --version
```

### 3. 「依存関係インストールエラー」

#### 症状
- npm install が失敗する
- 権限エラーが表示される

#### 解決方法
**方法1: ウイルス対策ソフト除外設定**
1. Windows Defender セキュリティセンター
2. ウイルスと脅威の防止 → 除外設定
3. フォルダーを除外 → アプリのフォルダを追加

**方法2: 管理者権限でインストール**
1. コマンドプロンプトを管理者として実行
2. アプリフォルダに移動
3. `npm install` を実行

**方法3: npm キャッシュクリア**
```cmd
npm cache clean --force
npm install
```

### 4. 「ポートが使用されています」エラー

#### 症状
- サーバー起動時に「EADDRINUSE」エラー
- ブラウザがアクセスできない

#### 解決方法
**方法1: 他のアプリを終了**
1. Taskマネージャーを開く
2. Node.jsプロセスを終了
3. ブラウザのタブを全て閉じる

**方法2: 別ポートを使用**
アプリは自動で別ポートを試行しますが、手動でも可能：
```cmd
set PORT=3000
node server\index.local.cjs
```

### 5. 「CommonJSエラー」または「ESモジュールエラー」

#### 症状
- `require is not defined` エラー
- モジュール読み込みエラー

#### 解決方法
**必ず server/index.local.cjs を使用してください：**
```cmd
node server\index.local.cjs
```
（.jsファイルではなく.cjsファイル）

### 6. ブラウザが自動で開かない

#### 解決方法
手動でブラウザを開いて以下にアクセス：
- メインURL: http://localhost:5000
- 代替ポート: http://localhost:5001 または http://localhost:3000

### 7. データが保存されない

#### 現在の仕様
**重要**: 現在はメモリストレージ使用のため、アプリ終了時にデータは消失します。

#### 対処法
- 重要なテキストは別途メモ帳などに保存
- 将来のアップデートでファイル保存機能を追加予定

### 8. AI機能が動作しない

#### 基本補完機能
- AIボタンを押しても何も起きない → サーバーログをチェック
- エラーメッセージが表示される → ブラウザの開発者ツールで詳細確認

#### Ollama連携（上級者向け）
1. [Ollama](https://ollama.ai/)をインストール
2. モデルをダウンロード：
```cmd
ollama pull llama3.2:3b
```
3. Ollamaサービスが起動していることを確認：
```cmd
ollama list
```

### 9. Windowsの文字化け

#### 症状
- コンソールで日本語が文字化けする
- アプリ内で文字が正しく表示されない

#### 解決方法
```cmd
chcp 65001
```

### 10. 完全リセット

#### すべてを初期化する場合
1. アプリを終了（Ctrl+C）
2. 以下のフォルダ/ファイルを削除：
   - `node_modules` フォルダ
   - `dist` フォルダ
   - `package-lock.json` ファイル
3. start-local.bat を再実行

## 緊急時の手動起動手順

すべてが失敗した場合の最低限起動方法：

```cmd
# 1. フォルダに移動
cd /d "C:\path\to\your\app"

# 2. 依存関係インストール（初回のみ）
npm install

# 3. ビルド（初回のみ）
npm run build

# 4. サーバー起動
node server\index.local.cjs
```

## サポート情報

### ログファイル場所
- アプリログ: コンソール出力のみ
- npmログ: `%APPDATA%\npm-cache\_logs\`

### システム要件再確認
- Windows 11 / Windows 10
- Node.js 18.x以上
- メモリ 4GB以上
- 空き容量 2GB以上

### 追加ヘルプ
問題が解決しない場合:
1. エラーメッセージの詳細をメモ
2. Node.jsバージョン確認
3. プロジェクト配布元に問い合わせ